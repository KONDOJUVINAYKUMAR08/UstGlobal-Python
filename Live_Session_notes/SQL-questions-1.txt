
Madan Mohan:
==============

1)Find employees who are not assigned to any project
  SEL
  FROM employees_table  
  WHERE e.id 
  NOT IN (SELECT employee_id FROM dept)

2)Find the nth highest salary from emp?
SELECT DISTINCT salary
FROM emp
ORDER BY salary DESC
LIMIT 1;

3) Find employees without department
SELECT *
FROM emp
WHERE deptno IS NULL;

4)Find dept without employees
SELECT d.*
FROM dept d
LEFT JOIN emp e ON d.deptno = e.deptno
WHERE e.deptno IS NULL;

5)Retrieve all employees who joined in 2023.
SELECT *
FROM emp
WHERE YEAR(hiredate) = 2023;

6)Find sal of emp whose salary is above the average sal of other departments.
SELECT e.empno, e.ename, e.deptno, e.sal
FROM emp e
WHERE e.sal > (
    SELECT AVG(s.sal)
    FROM emp s
    WHERE s.deptno > e.deptno);

7)Detect users with transactions from two different countries on the same day. 
SELECT customer_id,txn_date,
COUNT(DISTINCT country) AS distinct_countries
FROM transactions
WHERE country IS NOT NULL
GROUP BY customer_id, txn_date
HAVING COUNT(DISTINCT country) > 1;





8)Find customers who never placed an order
SELECT c.customer_id, c.name
FROM customers c
LEFT JOIN orders o
  ON c.customer_id = o.customer_id
WHERE o.customer_id IS NULL;

9) Find employees whose salary is above company average but below department average.
SELECT emp_id, dept_id, salary
FROM (
    SELECT e.*,
           AVG(salary) AS company_avg,
           AVG(salary) AS dept_avg
    FROM employees e) 
WHERE salary > company_avg
  AND salary < dept_avg;


================================================================================================================

